"use strict";(function(){var b=(function(){var w=0,p=0,v=0,o=0,t,y,n,q=[],s=[],r=[],u=[],x="";return{lat:w,lon:p,newLat:o,newLon:o,requestedIndex:t,requestedCode:y,requestedFacilityType:n,campusLocations:q,facilities:s,ThePubs:r,mapMarkers:u,userLocation:x};
}());$(document).bind("mobileinit",function(){$.mobile.defaultPageTransition="none";window.top.scrollTo(0,1);});function l(o,n){var q=o.title.toLowerCase(),p=n.title.toLowerCase();
return((q<p)?-1:((q>p)?1:0));}function m(){var s,r,t,q,p,o,n;}function i(p){var n=[],o=p;$(o).find("entry").each(function(){var q=new m();q.title=$(this).find("title").text();
q.longitude=$(this).find("longitude").text();q.latitude=$(this).find("latitude").text();q.code=$(this).find("code").text();q.link=$(this).find("link").text();
q.description=$(this).find("description").text();q.icon=$(this).find("icon").text();n.push(q);});if(n.length){b.campusLocations=n;}}function f(){$.ajax({type:"GET",url:"xml/locations.xml",dataType:"xml",success:i});
}function k(){var t,r,n,v,u,p,o,s,w,q;}function c(q){var p=[],n=q,o;$(n).find("entry").each(function(){var r=new k();r.title=$(this).find("title").text();
r.longitude=$(this).find("longitude").text();r.latitude=$(this).find("latitude").text();r.address=$(this).find("address").text();r.hours=$(this).find("hours").text();
r.contact=$(this).find("contact").text();r.code=$(this).find("code").text();r.link=$(this).find("link").text();r.description=$(this).find("description").text();
r.icon=$(this).find("icon").text();p.push(r);});if(p.length){b.ThePubs=p;}if(b.ThePubs.length){for(o=0;o<(b.ThePubs).length;o+=1){$("#ThePubsList").append('<li data-theme="c"><a href="#ThePubsDetailsPage"><h3>'+b.ThePubs[o].title+"</h3><p></p></a></li>");
}$("#ThePubsList").listview("refresh");}}function e(){$.ajax({type:"GET",url:"xml/12pubs.xml",dataType:"xml",success:c});}function d(p,n,r){if(p.hasClass("full-map")){p.css("height",($(window).height()/1.2));
}if(p.hasClass("half-map")){p.css("height",($(window).height()/2));}var q=p[0],o={zoom:r,center:n,mapTypeId:google.maps.MapTypeId.ROADMAP},s=new google.maps.Map(q,o);
return s;}function a(o,s,u,r){var n=124,q=$(window).width(),t=(window.devicePixelRatio>1)?2:1,p="http://maps.googleapis.com/maps/api/staticmap";p+="?center="+s+","+u;
p+="&zoom="+r;p+="&size="+q+"x"+n;p+="&scale="+t;p+="&maptype=roadmap";p+="&markers=color:0xD31A39%7C"+s+","+u;p+="&sensor=false";o.find("img").attr("src",p);
}function g(){if(navigator.geolocation!==undefined){navigator.geolocation.getCurrentPosition(function(n){b.userLocation=(n.coords.latitude+","+n.coords.longitude);
});}}function j(n,q){if((b.userLocation.length)&&(q.length)){var p=new google.maps.DirectionsService(),r,o={origin:b.userLocation,destination:n,travelMode:google.maps.DirectionsTravelMode.WALKING};
p.route(o,function(t,s){if(s===google.maps.DirectionsStatus.OK){r="Distance: "+t.routes[0].legs[0].distance.value+"m";q.html(r);}});}else{q.html("");}}function h(o,n){if(b.userLocation.length){var q=new google.maps.DirectionsService(),r,p={origin:b.userLocation,destination:o,travelMode:google.maps.DirectionsTravelMode.WALKING};
q.route(p,function(t,s){if(s===google.maps.DirectionsStatus.OK){r=t.routes[0].legs[0].distance.text;b.facilities[n].distance=r;}});}}$("#SplashPage").live("pageshow",function(n){window.setTimeout(function(){$.mobile.changePage(($("#Homepage")),{transition:"none",reverse:false,changeHash:false});
},3000);});$("#Homepage").live("pageinit",function(n){g();f();});$("#PubMap").live("pageshow",function(){b.newLat=53.3419119;b.newLon=-6.2614364;g();var u=new google.maps.LatLng(b.newLat,b.newLon),n=d($(this).find(".mapCanvas"),u,17),r=new google.maps.LatLngBounds(),p,s,q,x,t=new google.maps.InfoWindow(),w,v,o;
function y(z,B,A){google.maps.event.addListener(z,"click",function(){t.setContent("<h4>"+b.campusLocations[A].title+'</h4><p></p><a href="'+b.campusLocations[A].link+'">More information</a>');
t.open(B,this);});}window.setTimeout(function(){if(b.campusLocations.length){b.mapMarkers.length=0;for(v=0;v<(b.campusLocations).length;v+=1){s=new google.maps.LatLng(b.campusLocations[v].latitude,b.campusLocations[v].longitude);
w=new google.maps.Marker({position:s,map:n,title:b.campusLocations[v].title});b.mapMarkers.push(w);r.extend(s);n.fitBounds(r);y(w,n,v);}}else{f();}},1000);
google.maps.event.addListener(n,"zoom_changed",function(){var z=google.maps.event.addListener(n,"bounds_changed",function(A){if(this.getZoom()>18&&this.initialZoom===true){this.setZoom(18);
this.initialZoom=false;}google.maps.event.removeListener(z);});});$("#txtMapSearch").on("change keyup",function(){o=$("#txtMapSearch").val().toLowerCase();
p=new google.maps.LatLngBounds();if(o.length){for(v=0;v<(b.campusLocations).length;v+=1){if((b.campusLocations[v].title.toLowerCase().indexOf(o)===-1)&&(b.campusLocations[v].code.toLowerCase().indexOf(o)===-1)){b.mapMarkers[v].setVisible(false);
}else{b.mapMarkers[v].setVisible(true);n.initialZoom=true;p.extend(b.mapMarkers[v].position);}}if(!p.isEmpty()){n.fitBounds(p);}}else{for(v=0;v<(b.campusLocations).length;
v+=1){b.mapMarkers[v].setVisible(true);n.fitBounds(r);}}});$(".locate-me-btn").on("click, tap",function(){if(navigator.geolocation!==undefined){var z=new google.maps.MarkerImage("img/common/yourLoc.png",new google.maps.Size(44,44),new google.maps.Point(0,0),new google.maps.Point(22,22));
navigator.geolocation.getCurrentPosition(function(A){q=new google.maps.LatLng(A.coords.latitude,A.coords.longitude);w=new google.maps.Marker({icon:z,position:q,map:n,animation:google.maps.Animation.DROP,title:"You are here"});
n.panTo(q);});}else{alert("Geolocation services are not supported by your browser.");}});});$("#ThePubs").live("pageinit",function(n){e();$("#ThePubsList").on("click","a",function(){b.requestedIndex=$(this).closest("li").index();
});});$("#ThePubsDetailsPage").live("pageshow",function(r){g();if(b.ThePubs[b.requestedIndex]===undefined){$.mobile.changePage(($("#ThePubs")),{reverse:false,changeHash:false});
}else{var p=b.ThePubs[b.requestedIndex].latitude,q=b.ThePubs[b.requestedIndex].longitude,o=new google.maps.LatLng(p,q),s=d($(this).find(".mapCanvas"),o,17),n=new google.maps.Marker({position:o,map:s,title:" "});
$(this).find("h1").html(b.ThePubs[b.requestedIndex].title);$(this).find("#stuServicesTitle").html(b.ThePubs[b.requestedIndex].title+'<span class="sub-head"></span>');
j((p+","+q),$(this).find(".sub-head"));if(b.ThePubs[b.requestedIndex].hours.length){$(this).find(".open-hours").html(b.ThePubs[b.requestedIndex].hours);
$(this).find(".open-hours").show().prev("h3").show();}else{$(this).find(".open-hours").html("");$(this).find(".open-hours").hide().prev("h3").hide();}if(b.ThePubs[b.requestedIndex].contact.length){$(this).find(".phone-list").html(b.ThePubs[b.requestedIndex].contact);
$(this).find(".phone-list").show().prev("h3").show();}else{$(this).find(".phone-list").html("");$(this).find(".phone-list").hide().prev("h3").hide();}if(b.ThePubs[b.requestedIndex].address.length){$(this).find(".dept-address").html(b.ThePubs[b.requestedIndex].address);
}else{$(this).find(".dept-address").html("");}if(b.ThePubs[b.requestedIndex].description.length){$(this).find(".pub-description").html(b.ThePubs[b.requestedIndex].description);
$(this).find(".pub-description").show().prev("h3").show();}else{$(this).find(".pub-description").html("");$(this).find(".pub-description").hide().prev("h3").hide();
}}});$("#ThePubsDetailsPageFullMap").live("pageshow",function(p){if(b.ThePubs[b.requestedIndex]===undefined){$.mobile.changePage(($("#ThePubs")),{reverse:false,changeHash:false});
}else{var o=new google.maps.LatLng(b.ThePubs[b.requestedIndex].latitude,b.ThePubs[b.requestedIndex].longitude),q=d($(this).find(".mapCanvas"),o,17),n=new google.maps.Marker({position:o,map:q,title:"UCC"});
}});}());