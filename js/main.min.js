"use strict";(function(){var d=(function(){var l=0,n=0,m,k=[],j="";return{lat:l,lon:n,requestedIndex:m,ThePubs:k,userLocation:j};}());$(document).bind("mobileinit",function(){$.mobile.defaultPageTransition="none";
window.top.scrollTo(0,1);});function i(k,j){var m=k.title.toLowerCase(),l=j.title.toLowerCase();return((m<l)?-1:((m>l)?1:0));}function h(){var l,m,k,j;
}function a(m){var l=[],j=m,k;$(j).find("entry").each(function(){var n=new h();n.title=$(this).find("title").text();n.longitude=$(this).find("longitude").text();
n.latitude=$(this).find("latitude").text();n.description=$(this).find("description").text();l.push(n);});if(l.length){d.ThePubs=l;}if(d.ThePubs.length){for(k=0;
k<(d.ThePubs).length;k+=1){$("#ThePubsList").append('<li data-theme="c"><a href="#ThePubsDetailsPage"><h3>'+d.ThePubs[k].title+"</h3><p></p></a></li>");
}}}function c(){$.ajax({type:"GET",url:"xml/12pubs.xml",dataType:"xml",success:a});}function b(l,j,n){if(l.hasClass("full-map")){l.css("height",($(window).height()/1.2));
}if(l.hasClass("half-map")){l.css("height",($(window).height()/2));}var m=l[0],k={zoom:n,center:j,mapTypeId:google.maps.MapTypeId.ROADMAP},o=new google.maps.Map(m,k);
return o;}function e(){if(navigator.geolocation!==undefined){navigator.geolocation.getCurrentPosition(function(j){d.userLocation=(j.coords.latitude+","+j.coords.longitude);
});}}function g(j,m){if((d.userLocation.length)&&(m.length)){var l=new google.maps.DirectionsService(),n,k={origin:d.userLocation,destination:j,travelMode:google.maps.DirectionsTravelMode.WALKING};
l.route(k,function(p,o){if(o===google.maps.DirectionsStatus.OK){n="Distance: "+p.routes[0].legs[0].distance.value+"m";m.html(n);}});}else{m.html("");}}function f(k,j){if(d.userLocation.length){var m=new google.maps.DirectionsService(),n,l={origin:d.userLocation,destination:k,travelMode:google.maps.DirectionsTravelMode.WALKING};
m.route(l,function(p,o){if(o===google.maps.DirectionsStatus.OK){n=p.routes[0].legs[0].distance.text;d.facilities[j].distance=n;}});}}$("#SplashPage").live("pageshow",function(j){c();
window.setTimeout(function(){$.mobile.changePage(($("#Homepage")),{transition:"none",reverse:false,changeHash:false});},2000);});$("#Homepage").live("pageinit",function(j){e();
if(d.ThePubs.length===0){c();}window.setTimeout(function(){$("#ThePubsList").listview("refresh");},100);$("#ThePubsList").on("click","a",function(){d.requestedIndex=$(this).closest("li").index();
});});$("#ThePubsDetailsPage").live("pageshow",function(n){if(d.ThePubs[d.requestedIndex]===undefined){$.mobile.changePage(($("#Homepage")),{reverse:false,changeHash:false});
}else{var l=d.ThePubs[d.requestedIndex].latitude,m=d.ThePubs[d.requestedIndex].longitude,k=new google.maps.LatLng(l,m),o=b($(this).find(".mapCanvas"),k,17),j=new google.maps.Marker({position:k,map:o,title:" "});
$(this).find("h1").html(d.ThePubs[d.requestedIndex].title);$(this).find("#pubTitle").html(d.ThePubs[d.requestedIndex].title+'<span class="sub-head"></span>');
g((l+","+m),$(this).find(".sub-head"));if(d.ThePubs[d.requestedIndex].description.length){$(this).find(".pub-description").html(d.ThePubs[d.requestedIndex].description);
$(this).find(".pub-description").show().prev("h3").show();}else{$(this).find(".pub-description").html("");$(this).find(".pub-description").hide().prev("h3").hide();
}}});}());